#!/bin/bash

BASEDIR="$HOME/.local/build"
BUILDDIR="$BASEDIR/neovim/"
BUILDTAG="v0.2.2"

if [ -d $BUILDDIR ]; then
    cd $BUILDDIR
    git fetch origin
    git merge origin/master
else
    if [ ! -d $BASEDIR ]; then
        mkdir -p $BASEDIR
    fi
    cd $BASEDIR
    git clone https://github.com/neovim/neovim.git
fi

cd $BUILDDIR
git checkout tags/$BUILDTAG
sudo apt-get -y install libtool libtool-bin autoconf automake cmake g++ pkg-config unzip
cd ~/.local/build/neovim/
make CMAKE_BUILD_TYPE=RelWithDebInfo CMAKE_EXTRA_FLAGS="-DCMAKE_INSTALL_PREFIX:PATH=$HOME/.local/neovim"
make install
ln -s ~/.local/neovim/bin/nvim ~/.local/bin
